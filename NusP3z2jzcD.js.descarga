if (self.CavalryLogger) { CavalryLogger.start_js(["sGe+Z"]); }

__d("GeneratedSinkUtils",["ArtilleryStringDictionary","Bootloader","GeneratedSinkReliability","invariant"],(function a(b,c,d,e,f,g,h,i,j,k){"use strict";__p&&__p();var l=void 0,m=false;function n(){if(l!=null||m)return;m=true;i.loadModules(["GeneratedPackerUtils"],function(r){var s=r.composePackerForSink;l=s;m=false},"GeneratedSinkUtils")}function o(r,s){switch(r){case"float64":return{type:"arrayBuffer",array:new Float64Array(s)};case"string":return{type:"stringBuffer",strings:new h(),stringIndexes:new Uint32Array(s)};default:throw new Error("Unsupported entry property type ("+r+")")}}function p(r,s,t){__p&&__p();var u,v;switch(r){case"float64":var u=function(){t.type==="arrayBuffer"||k(0);var w=t;return{v:function x(y,z){w.array[z]=y[s]}}}();if(typeof u==="object")return u.v;case"string":var v=function(){t.type==="stringBuffer"||k(0);var w=t;return{v:function x(y,z){w.stringIndexes[z]=w.strings.add(y[s])}}}();if(typeof v==="object")return v.v;default:throw new Error("Unknown pusher type ("+r+")")}}function q(r,s,t,u){__p&&__p();return function(){__p&&__p();function v(){"use strict";__p&&__p();this.$GeneratedSink1=0;this.$GeneratedSink2={};this.$GeneratedSink4=[];this.$GeneratedSink5=0;var w=r.scalars,x=r.entries;for(var y=Object.keys(w),z=Array.isArray(y),A=0,y=z?y:y[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var B;if(z){if(A>=y.length)break;B=y[A++]}else{A=y.next();if(A.done)break;B=A.value}var C=B;this.$GeneratedSink2[C]={type:"scalarBuffer",value:null}}for(var D=Object.keys(x),E=Array.isArray(D),F=0,D=E?D:D[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var G;if(E){if(F>=D.length)break;G=D[F++]}else{F=D.next();if(F.done)break;G=F.value}var H=G;this.$GeneratedSink2[H]=o(x[H],t);this.$GeneratedSink4.push(p(x[H],H,this.$GeneratedSink2[H]))}}v.prototype.addEntry=function(w){"use strict";if(this.isActive()){this.$GeneratedSink4.forEach(function(x){x(w,this.$GeneratedSink6(this.$GeneratedSink1))}.bind(this));this.$GeneratedSink1+=1}};v.prototype.isActive=function(){"use strict";return this.$GeneratedSink5>0};v.prototype.open=function(){"use strict";__p&&__p();j.bumpCounter("open",u);n();var w=this.$GeneratedSink1;this.$GeneratedSink5+=1;var x={close:function(){var y=arguments.length<=0||arguments[0]===undefined?false:arguments[0];j.bumpCounter("close",u);this.$GeneratedSink5-=1;if(y)return null;return this.$GeneratedSink7(w,this.$GeneratedSink1)}.bind(this)};return x};v.prototype.setScalar=function(w,x){"use strict";var y=this.$GeneratedSink2[w];y!=null&&y.type==="scalarBuffer"||k(0);y.value=x};v.prototype.$GeneratedSink6=function(w){"use strict";return w%t};v.prototype.$GeneratedSink8=function(w,x){"use strict";__p&&__p();var y=Math.max(0,this.$GeneratedSink1-t),z=y>w,A=[];if(w===x||z&&y>=x)A.push([0,0]);else{var B=z?y:w,C=this.$GeneratedSink6(B),D=this.$GeneratedSink6(x);if(D>C)A.push([C,D]);else{A.push([C,t]);if(D>0)A.push([0,D])}}return{hasOverflown:z,segments:A}};v.prototype.$GeneratedSink7=function(w,x){"use strict";__p&&__p();if(l==null){j.bumpCounter("packer_not_loaded",u);return null}var y=this.$GeneratedSink8(w,x),z=y.hasOverflown,A=y.segments,B=null;try{B=l(r)(this.$GeneratedSink2,A,z);j.bumpCounter("pack_success",u)}catch(C){j.bumpCounter("pack_failed_exception",u)}return B};return v}()}f.exports={createSink:q}}),null);